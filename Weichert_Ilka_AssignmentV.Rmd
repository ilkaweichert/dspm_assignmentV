---
title: "Assignment 5"
author: "Submitted by Ilka Weichert (Student ID: 4161194)"
date: "February 16th, 2021"
output: 
  html_document:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

I worked on my own. I hereby assure that my submission is in line with the 
*Code of Conduct* outlined on the lecture slides.

## General setup

Note that task descriptions are printed in bold letters. Only the descriptions
that are important for operations in R are included.

Before I start the project, I clear my workspace.

```{r packages, message=FALSE, warning=F}
rm(list = ls())  # clear workspace
```

## Exercise 2: Getting to know the API
**Familiarize yourself with the features and functionalities of the Ticketmaster**
**Discovery API. Have a particular look at rate limits.**

**Within the scope of this assignment, you do not have to request your own API **
**key. Instead retrieve a valid key from the API Explorer. This API key enables**
**you to perform the GET requests needed throughout this assignment.**

**Even though this API key is not secret per se (it is publicly visible on the** 
**API Explorer website),please comply to the common secrecy practices discussed**
**in the lecture and the tutorial: Treat the API key as a secret token. Your **
**API key should neither appear in the code that you are submitting nor in your**
**public GitHub repository.**

## Exercise 3: Interacting with the API - the basics

**Load the packages needed to interact with APIs using R.**


**Perform a first GET request, that searches for event venues in Germany **
**(countryCode = "DE"). Extract the content from the response object and **
**inspect the resulting list. Describe what you can see.**

**Extract the name, the city, the postalCode and address, as well as the url **
**and the longitude and latitude of the venues to a data frame. This data frame**
**should have the following structure:**

**glimpse(venue_data)**

##Exercise 4: Interacting with the API - advanced

**Have a closer look at the list element named page. Did your GET request from**
**exercise 3 return all event locations in Germany? Obviously not - there are **
**of course much more venues in Germany than those contained in this list. Your**
**GET request only yielded the first results page containing the first 20 out of**
**several thousands of venues.**

**Check the API documentation under the section Venue Search. How can you **
**request the venues from the remaining results pages?**

**Write a for loop that iterates through the results pages and performs a GET**
**request for all venues in Germany. After each iteration, extract the seven**
**variables name, city, postalCode, address, url, longitude, and latitude. Join**
**the information in one large data frame.**

**The resulting data frame should look something like this (note that the exact**
**number of search results may have changed since this document has been last**
**modified):**

**glimpse(venue_data)**

##Exercise 5: Visualizing the extracted data

**Below, you can find code that produces a map of Germany. Add points to the **
**map indicating the locations of the event venues across Germany.**

**You will find that some coordinates lie way beyond the German borders and can**
**be assumed to be faulty. Set coordinate values to NA where the value of **
**longitude is outside the range (5.866944, 15.043611) or where the value of**
**latitude is outside the range (47.271679, 55.0846) (these coordinate ranges**
**have been derived from the extreme points of Germany as listed on Wikipedia**
**(see here). For extreme points of other countries, see here).**

```{r map_germany}

ggplot() +
geom_polygon(
aes(x = long, y = lat, group = group), data = map_data("world", region = "Germany"),
fill = "grey90",color = "black") +
theme_void() + coord_quickmap() +
labs(title = "Event locations across Germany", caption = "Source: ticketmaster.com") +
theme(title = element_text(size = 8, face = 'bold'),
plot.caption = element_text(face = "italic"))
```

##Exercise 6: Event locations in other countries

**Repeat exercises 2 to 5 for another European country of your choice. (Hint:**
**Clean code pays off! If you have coded the exercises efficiently, only very **
**few adaptions need to be made.)**

